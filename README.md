# GeoBot - Telegram бот для учёта сплавов на сапборде

Бот для отслеживания сплавов с загрузкой GPX треков и генерацией инфографики.

## Возможности

- 📊 Загрузка GPX треков
- 📈 Автоматический расчёт метрик (расстояние, скорость, высота)
- 🖼️ Генерация инфографики с графиками
- 📷 Прикрепление фото и видео
- 📋 Просмотр списка сплавов с пагинацией
- ✏️ Редактирование медиа
- 🗑️ Удаление сплавов
- 📉 Статистика за период (день/неделя/месяц/год)

## Установка

1. Клонировать репозиторий
2. Установить зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Настроить конфигурацию:
   ```bash
   cp .env.example .env
   ```
   Отредактировать `.env`:
   - `ADMIN_ID` - ваш Telegram ID
   - `BOT_TOKEN` - токен от @BotFather
   - `WEBHOOK_URL` - URL для вебхука (опционально)

## Запуск

### С полингом (для тестирования):
```bash
python bot/main.py
```

### С вебхуком (для продакшена):
```bash
python bot/main.py
```

Настроить nginx для проксирования вебхука:
```nginx
location /webhook {
    proxy_pass http://localhost:8000/webhook;
}
```

## Команды бота

- `/start` - приветствие и инструкции
- `/list` - список всех сплавов
- `/stats [day|week|month|year|all]` - статистика
- `/last` - последний сплав

## Структура проекта

```
geobot/
├── bot/
│   ├── main.py              # точка входа
│   ├── handlers/            # хэндлеры команд
│   │   ├── track.py         # загрузка GPX
│   │   ├── media.py         # фото/видео
│   │   ├── list.py          # список сплавов
│   │   ├── view.py          # просмотр сплава
│   │   ├── edit.py          # редактирование
│   │   ├── delete.py        # удаление
│   │   └── stats.py         # статистика
│   ├── services/            # бизнес-логика
│   │   ├── gpx_parser.py    # парсинг GPX
│   │   ├── calculator.py    # расчёты
│   │   └── graphics.py      # генерация картинок
│   └── models/              # модели данных
│       ├── trip.py          # сплав
│       └── media.py         # медиа
├── database/
│   └── db.py                # SQLite
├── data/                    # хранилище файлов
│   ├── tracks/
│   ├── media/
│   └── graphics/
├── config.py                # конфигурация
├── requirements.txt
└── README.md
```

## Лицензия

MIT
